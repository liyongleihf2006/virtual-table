(function(e){function t(t){for(var r,i,o=t[0],s=t[1],c=t[2],h=0,d=[];h<o.length;h++)i=o[h],Object.prototype.hasOwnProperty.call(l,i)&&l[i]&&d.push(l[i][0]),l[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==l[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},l={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/virtual-table/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),l=n("5c96"),a=n.n(l),i=(n("0fae"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{on:{click:e.handleSubmit}},[e._v("提交")]),n("button",{on:{click:e.handleToggleRowSelection}},[e._v("切换第一条的选中状态")]),n("button",{on:{click:e.handleToggleAllSelection}},[e._v("切换所有数据的选中状态")]),n("button",{on:{click:e.handleClearSelection}},[e._v("清空所有选中的选中状态")]),n("button",{on:{click:e.handleGetCleanVirtualData}},[e._v("获取干净的数据")]),n("button",{on:{click:e.handleClearValidate}},[e._v("清空所有数据的错误验证")]),n("button",{on:{click:e.handleClearSingleValidate}},[e._v("清空0-0的age的错误验证")]),n("virtual-table",{ref:"virtualTable",attrs:{height:"1000px",border:"","show-summary":"","table-data":e.tableData,"validate-map":e.validateMap,selection:!0,"default-expand-all":!0},on:{"selection-change":e.handleSelectionChange,"select-all":e.handleSelectAll,select:e.handleSelect,"forward-table-ref":function(t){return e.tableRef=t}}},[n("virtual-table-column",{attrs:{width:"300",prop:"name",label:"姓名",fixed:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(t.row.name)+" ")])]}},{key:"edit",fn:function(t){return[n("el-input",{model:{value:t.row.name,callback:function(n){e.$set(t.row,"name",n)},expression:"scope.row.name"}})]}}])}),n("el-table-column",{attrs:{label:"基本信息"}},[n("virtual-table-column",{attrs:{width:"300",prop:"age",label:"年龄"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text center"},[e._v(" "+e._s(t.row.age)+" ")])]}},{key:"edit",fn:function(t){return[n("el-input-number",{attrs:{controls:!1},model:{value:t.row.age,callback:function(n){e.$set(t.row,"age",n)},expression:"scope.row.age"}})]}}])}),n("virtual-table-column",{attrs:{width:"300",prop:"nation",label:"民族"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(e._f("nationFilter")(t.row.nation))+" ")])]}},{key:"edit",fn:function(t){return[n("el-select",{model:{value:t.row.nation,callback:function(n){e.$set(t.row,"nation",n)},expression:"scope.row.nation"}},e._l(e.nations,(function(e){var t=e.value,r=e.label;return n("el-option",{key:t,attrs:{value:t,label:r}})})),1)]}}])}),n("virtual-table-column",{attrs:{width:"300",prop:"address",label:"住址"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(t.row.address)+" ")])]}},{key:"edit",fn:function(t){return[n("el-input",{attrs:{type:"textarea"},model:{value:t.row.address,callback:function(n){e.$set(t.row,"address",n)},expression:"scope.row.address"}})]}}])})],1),n("virtual-table-column",{attrs:{width:"300",prop:"entryTime",label:"入职时间"}}),n("el-table-column",{attrs:{label:"其他信息"}},[n("virtual-table-column",{attrs:{width:"300",prop:"hobby",label:"爱好"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(e._f("hobbyFilter")(t.row.hobby))+" ")])]}},{key:"edit",fn:function(t){return[n("el-select",{model:{value:t.row.hobby,callback:function(n){e.$set(t.row,"hobby",n)},expression:"scope.row.hobby"}},e._l(e.hobbys,(function(e){var t=e.value,r=e.label;return n("el-option",{key:t,attrs:{value:t,label:r}})})),1)]}}])}),n("virtual-table-column",{attrs:{width:"300",prop:"healthy",label:"健康状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(e._f("healthyFilter")(t.row.healthy))+" ")])]}},{key:"edit",fn:function(t){return[n("el-select",{model:{value:t.row.healthy,callback:function(n){e.$set(t.row,"healthy",n)},expression:"scope.row.healthy"}},e._l(e.healthys,(function(e){var t=e.value,r=e.label;return n("el-option",{key:t,attrs:{value:t,label:r}})})),1)]}}])}),n("virtual-table-column",{attrs:{width:"300",prop:"food",label:"食物偏好"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(e._f("foodFilter")(t.row.food))+" ")])]}},{key:"edit",fn:function(t){return[n("el-select",{model:{value:t.row.food,callback:function(n){e.$set(t.row,"food",n)},expression:"scope.row.food"}},e._l(e.foods,(function(e){var t=e.value,r=e.label;return n("el-option",{key:t,attrs:{value:t,label:r}})})),1)]}}])}),n("virtual-table-column",{attrs:{width:"300",prop:"smoke",label:"是否抽烟"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"el-input__inner el-input-text"},[e._v(" "+e._s(e._f("smokeFilter")(t.row.smoke))+" ")])]}},{key:"edit",fn:function(t){return[n("el-select",{model:{value:t.row.smoke,callback:function(n){e.$set(t.row,"smoke",n)},expression:"scope.row.smoke"}},e._l(e.smokes,(function(e){var t=e.value,r=e.label;return n("el-option",{key:t,attrs:{value:t,label:r}})})),1)]}}])})],1)],1)],1)}),o=[],s=(n("7db0"),n("d81d"),n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("0481"),n("07ac"),n("96eb")),c=[{value:"0",label:"篮球"},{value:"1",label:"足球"},{value:"2",label:"乒乓球"},{value:"3",label:"羽毛球"},{value:"4",label:"跑步"},{value:"5",label:"游泳"},{value:"6",label:"长跑"},{value:"7",label:"美食"}],u=[{value:"0",label:"汉族"},{value:"1",label:"回族"},{value:"3",label:"苗族"},{value:"4",label:"维吾尔族"},{value:"5",label:"土家族"},{value:"6",label:"客家族"},{value:"7",label:"傣族"}],h=[{value:"0",label:"健康"},{value:"1",label:"亚健康"}],d=[{value:"0",label:"肉类"},{value:"1",label:"蔬菜"}],f=[{value:"0",label:"是"},{value:"1",label:"否"}],p={filters:{hobbyFilter:function(e){var t=c.find((function(t){return t.value===e}));return t.label},nationFilter:function(e){var t=u.find((function(t){return t.value===e}));return t.label},healthyFilter:function(e){var t=h.find((function(t){return t.value===e}));return t.label},foodFilter:function(e){var t=d.find((function(t){return t.value===e}));return t.label},smokeFilter:function(e){var t=f.find((function(t){return t.value===e}));return t.label}},data:function(){var e=s.mock({"list|10":[{id:"@guid",name:"@cname",age:"@integer(20,40)",address:"@county(true)",entryTime:'@date("yyyy-MM-dd")',"hobby|1":c.map((function(e){var t=e.value;return t})),"nation|1":u.map((function(e){var t=e.value;return t})),"healthy|1":h.map((function(e){var t=e.value;return t})),"food|1":d.map((function(e){var t=e.value;return t})),"smoke|1":f.map((function(e){var t=e.value;return t})),"children|10-20":[{id:"@guid",name:"@cname",age:"@integer(20,40)",address:"@county(true)",entryTime:'@date("yyyy-MM-dd")',"hobby|1":c.map((function(e){var t=e.value;return t})),"nation|1":u.map((function(e){var t=e.value;return t})),"healthy|1":h.map((function(e){var t=e.value;return t})),"food|1":d.map((function(e){var t=e.value;return t})),"smoke|1":f.map((function(e){var t=e.value;return t})),"children|10-20":[{id:"@guid",name:"@cname",age:"@integer(20,40)",address:"@county(true)",entryTime:'@date("yyyy-MM-dd")',"hobby|1":c.map((function(e){var t=e.value;return t})),"nation|1":u.map((function(e){var t=e.value;return t})),"healthy|1":h.map((function(e){var t=e.value;return t})),"food|1":d.map((function(e){var t=e.value;return t})),"smoke|1":f.map((function(e){var t=e.value;return t}))}]}]}]});return{lineHeight:44,tableData:e.list,hobbys:c,nations:u,healthys:h,foods:d,smokes:f,validateMap:new Map([[["name"],function(){var e=!0,t=[];return e&&(t=[{required:!0,message:"请填写名称"}]),{isFormItem:e,rules:t}}],[["age"],function(e){var t=!0,n=[];return t&&(n=[{required:!0,message:"请填写年龄"},{validator:function(t,n,r){""===n?r("请输入年龄"):(e.age>100&&r("年龄不能大于100岁"),r())}}]),{isFormItem:t,rules:n}}]]),multipleSelection:[]}},mounted:function(){},methods:{handleClearSingleValidate:function(){var e=this.$refs.virtualTable,t=this.tableData[0].children[0];e.clearValidate({rows:t,props:"age"})},handleClearValidate:function(){var e=this.$refs.virtualTable;e.clearValidate()},handleGetCleanVirtualData:function(){console.log("被虚拟表格处理过的数据",this.tableData);var e=this.$refs.virtualTable,t=e.getCleanVirtualData();console.log("干净的数据",t)},handleSelect:function(e,t,n){console.log("handleSelect",e,t,n),this.multipleSelection=e},handleSelectAll:function(e){console.log("handleSelectAll",e),this.multipleSelection=e},handleSelectionChange:function(e){console.log("handleSelectionChange",e),this.multipleSelection=e},handleClearSelection:function(){var e=this.$refs.virtualTable;e.clearSelection()},handleToggleAllSelection:function(){var e=this.$refs.virtualTable;e.toggleAllSelection()},handleToggleRowSelection:function(){var e=this.$refs.virtualTable;e.toggleRowSelection(this.tableData[0])},handleSubmit:function(){var e=this,t=this.$refs.virtualTable;t.validate((function(t,n){if(console.log(t),console.log(n),t)e.$message({message:"数据提交成功",type:"success"});else{var r=Object.values(n).flat();e.$message.error(r[0].message)}}))}}},v=p,b=(n("034f"),n("2877")),g=Object(b["a"])(v,i,o,!1,null,null,null),m=g.exports;n("b0c0"),n("159b");delete l["Table"]._Ctor,Object.assign(l["Table"],{inheritAttrs:!1});var y=l["Table"].methods.bindEvents,_=l["Table"].methods.unbindEvents;Object.assign(l["Table"].methods,{bindEvents:function(){var e=this;y.call(this),this.bodyWrapper.addEventListener("scroll",(function(t){e.$emit("scroll",t)}));var t=new ResizeObserver((function(){e.resize({type:"resize"})}));t.observe(this.$el)},unbindEvents:function(){_.call(this),window.removeEventListener("resize",this.resize)},resize:function(e){this.$emit("resize",e)}});var w=l["Table"],k=n("5530");delete l["TableColumn"]._Ctor;var x=l["TableColumn"].methods.setColumnRenders;Object.assign(l["TableColumn"].methods,{setColumnRenders:function(e){var t=this;return e=x.call(this,e),"selection"===e.type&&(this.$slots.header||this.$scopedSlots.header)&&(e.renderHeader=function(e,n){return t.$scopedSlots.header(n)}),e}});var C={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:"",className:"el-table-column--selection"},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}};function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function O(e,t){var n,r={};for(n in e)r[n]=e[n];for(n in t)if(S(t,n)){var l=t[n];"undefined"!==typeof l&&(r[n]=l)}return r}function $(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var T=1;Object.assign(l["TableColumn"],{beforeCreate:function(){this.row={},this.column={},this.$index=0,this.columnId=""},created:function(){var e=this.columnOrTableParent;this.isSubColumn=this.owner!==e,this.columnId=(e.tableId||e.columnId)+"_column_"+T++;var t=this.type||"default",n=""===this.sortable||this.sortable,r=Object(k["a"])(Object(k["a"])({},C[t]),{},{id:this.columnId,type:t,property:this.prop||this.property,align:this.realAlign,headerAlign:this.realHeaderAlign,showOverflowTooltip:this.showOverflowTooltip||this.showTooltipWhenOverflow,filterable:this.filters||this.filterMethod,filteredValue:[],filterPlacement:"",isColumnGroup:!1,filterOpened:!1,sortable:n,index:this.index}),l=["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],a=["sortMethod","sortBy","sortOrders"],i=["selectable","reserveSelection"],o=["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement"],s=this.getPropsData(l,a,i,o);s=O(r,s);var c=$(this.setColumnRenders,this.setColumnWidth,this.setColumnForcedProps);s=c(s),this.columnConfig=s,this.registerNormalWatchers(),this.registerComplexWatchers()}});var H=l["TableColumn"],j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._g(e._b({ref:"tableRef",staticClass:"virtual-table",attrs:{"show-header":e.showHeader,"expand-row-keys":e.expandRowKeys,data:e.realData,"row-key":e.rowKey,"tree-props":e._treeProps,"span-method":e.spanMethod||e.defaultSpanMethod,"default-expand-all":!1},on:{"cell-click":e.cellClick,"expand-change":e.expandChange,scroll:e.handleScroll}},"el-table",Object.assign({},e.$props,e.$attrs),!1),Object.assign({},e.$listeners)),[e.selection?n("el-table-column",{attrs:{type:"selection",width:e.selectionWidth},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-checkbox",{attrs:{value:r._checked,indeterminate:r._indeterminate},on:{change:function(t){return e.handleSelect(t,r)}}})]}}],null,!1,3256433669)},[n("template",{slot:"header"},[n("el-checkbox",{staticClass:"checkAll",attrs:{indeterminate:e.checkAllIndeterminate},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}})],1)],2):e._e(),e._t("default")],2)},E=[],R=n("3835"),A=n("b85c"),D=n("2909"),P=(n("a9e3"),n("c760"),n("caad"),n("2532"),n("c7cd"),n("4de4"),n("99af"),n("b64b"),n("4fad"),n("a434"),n("fb6a"),n("6062"),n("2ef0")),F=n("a15e");function K(e){return Object.prototype.toString.call(e)}function I(e){return"[object Array]"===K(e)}function V(e){return"[object Object]"===K(e)}function M(e,t,n){var r=Object(P["cloneDeep"])(e);return l(r),r;function l(e){if(V(e)){var r=Object.keys(e);r.forEach((function(n){t.includes(n)&&delete e[n]}));var a=e[n];a&&l(a)}else I(e)&&e.forEach((function(e){l(e)}))}}var L=M,q=(n("7ed3"),[]),W=new Proxy({id:""},{set:function(e,t,n){return q.forEach((function(e){e(n)})),Reflect.set(e,t,n)},get:function(e){return e}}),N=function(e){q.push(e)},z=W,G={name:"VirtualTable",inheritAttrs:!1,props:{selection:{type:Boolean,default:!1},treeProps:{type:Object,default:function(){return{children:"children",hasChildren:"hasChildren"}}},rowKey:{type:String,default:"id"},defaultExpandAll:{type:Boolean,default:!0},tableData:{type:Array,default:function(){return[]}},lineHeight:{type:Number,default:44},validateMap:{type:Map,default:function(){return new Map}},expandRowKeys:{type:Array,default:function(){return[]}},spanMethod:{type:Function,default:null}},data:function(){return{selectionWidth:55,hasDefaultExpandAll:!1,realData:[],prevScrollTop:0,prevScrollLeft:0,virtualIds:[],realCols:[],showHeader:!0,validateHash:this.getValidateHash(this.validateMap),visibleNodes:[]}},provide:function(){return{validateField:this.validateField}},computed:{checkAll:{get:function(){var e=this.tableData;if(!e.length)return!1;var t=e.every((function(e){return e._checked}));return t},set:function(e){var t=this.doCheck(e);this.$emit("select-all",t)}},checkAllIndeterminate:function(){var e=this.tableData;if(!e.length)return!1;var t=e.every((function(e){return e._checked})),n=e.every((function(e){return!e._checked}));return!t&&!n},childrenKey:function(){return this._treeProps.children},_treeProps:function(){var e=this.treeProps,t=e.children,n=e.hasChildren;return{children:"_".concat(t),hasChildren:n}}},watch:{checkAll:{handler:function(){this.hackCheckAllChange()}},checkAllIndeterminate:{handler:function(){this.hackCheckAllChange()}},"$slots.default":{handler:function(e){var t=this;setTimeout((function(){t.visibleNodes=t._getVisibleNodes(e)}))},immediate:!0,deep:!0}},created:function(){this.warning()},mounted:function(){var e=this;this.watchFlatLen(),this.initTable(),this.$nextTick((function(){e.getRealCols(),e.getRealData()})),this.debounceOnScroll=this.onScroll||Object(P["debounce"])(this.onScroll),this.$emit("forward-table-ref",this.$refs.tableRef)},methods:{cellClick:function(e,t,n){z.id=e.id,this.$nextTick((function(){var e=n.querySelector(".el-select"),t=n.querySelector("input,textarea");e?e.click():t&&t.focus()}))},onScroll:function(){var e=this.$refs.tableRef.$el,t=e.querySelector(".el-table__body-wrapper");t.scrollLeft!==this.prevScrollLeft&&this.getRealCols(),t.scrollTop!==this.prevScrollTop&&(this.prevScrollTop=t.scrollTop,this.getRealData())},_getVisibleNodes:function(e){return t(e);function t(e){var n=[];return e.forEach((function(e){if(e.tag){n.push(e);var r=e.componentOptions,l=r.children;if(l){var a=t(l);r.children=a}}})),n}},isHasAttrs:function(e){return Reflect.has(this.$attrs,e)},warning:function(){var e="VirtualTable",t=this.visibleNodes,n=t.some((function(e){return"selection"===e.componentOptions.propsData.type}));n&&console.error("".concat(e,":因组件自己实现了多选功能,请不要使用Element的多选组件,请在VirtualTable实例上面使用selection属性并设置为true"));var r=this.$attrs;console.log(r),this.isHasAttrs("show-header")&&console.error("".concat(e,":因组件中,show-header属性用于hack表头不能实时渲染的问题,所以传入该属性将不起作用")),this.defaultExpandAll&&this.expandRowKeys.length&&console.error("".concat(e,":当传入expand-row-keys的长度不为空的时候,default-expand-all=true将不起作用")),this.spanMethod&&console.error("".concat(e,":因spanMethod用于了内部性能优化,因此传入spanMethod会导致部分性能优化失效,倘若一定要使用,那么在自己实现的时候请参照一下组件中spanMethod的实现"))},defaultSpanMethod:function(e){var t=e.row,n=e.column,r=e.columnIndex;if(this.virtualIds.includes(t[this.rowKey]))return[0,0];if(n.fixed)return[1,1];var l=this.$refs.tableRef.columns,a=l.filter((function(e){return["left",!0].includes(e.fixed)})).length,i=l.filter((function(e){return"right"===e.fixed})).length,o=this.realCols.length,s=+this.realCols[a]-4,c=+this.realCols[o-1]+1;return r<s+1?[0,0]:r===s+1?[1,s+2-a]:r===c?[1,l.length-c-i]:r>c?[0,0]:void 0},getCleanVirtualData:function(){var e=[this.childrenKey,"_checked","_prop","_errorFields","_ancestors","_parent","_validates","_indeterminate"];return L(this.tableData,e,this.treeProps.children)},pretreatment:function(e,t,n){var l=this,a=function e(t,n,a){t.forEach((function(t,i){var o="".concat(n,".").concat(i);t._prop=o,t._errorFields||r["default"].set(t,"_errorFields",[]),a&&(t._ancestors=[a].concat(Object(D["a"])(a._ancestors||[])),t._parent=a),Object.keys(t).forEach((function(e){var n=l.validateHash[e];n&&(t._validates||(t._validates={}),t._validates[e]=n(t))}));var s=l.treeProps.children,c=t[s];c&&(l.defaultExpandAll&&!l.hasDefaultExpandAll&&l.expandRowKeys.push(t[l.rowKey]),e(c,"".concat(o,".").concat(s),t))}))};a(e,t),n&&(this.hasDefaultExpandAll=!0)},getValidateHash:function(e){var t,n={},r=Object(A["a"])(e.entries());try{var l=function(){var e=Object(R["a"])(t.value,2),r=e[0],l=e[1];r.forEach((function(e){n[e]=l}))};for(r.s();!(t=r.n()).done;)l()}catch(a){r.e(a)}finally{r.f()}return n},doValidator:function(e){var t=this,n=[],r=[];return l.call(this,e),Promise.all(r).then((function(){for(var e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];var a=r.flat().filter((function(e){return e}));if(a.length){t.hasDoValidator=!0;var i={};return a.forEach((function(e){Object.assign(i,e)})),{valid:!1,invalids:i,rows:n}}return{valid:!0,invalids:{},rows:[]}}));function l(e){var t=this;e.forEach((function(e){var a={};if(Object.keys(e).forEach((function(n){var r=t.validateHash[n];if(r){var l=r(e),i=l.rules,o=l.isFormItem;o&&(a[n]=i)}})),Object.keys(a).length){var i=new F["default"](a),o=new Promise((function(t){i.validate(e,(function(r,l){if(l){var a={};Object.entries(l).forEach((function(t){var n=Object(R["a"])(t,2),r=n[0],l=n[1],i="".concat(e._prop,".").concat(r),o=l.map((function(e){return Object(k["a"])(Object(k["a"])({},e),{},{field:i})}));a[i]=o,e._errorFields.push(r)})),n.push(e),t(a)}else e._errorFields=[],t()}))}));r.push(o)}l.call(t,e[t.treeProps.children]||[])}))}},validate:function(e){var t=this;window.requestIdleCallback((function(){var n=t.tableData;t.doValidator(n).then((function(n){var r=n.valid,l=n.invalids,a=n.rows,i=a[0];i&&t.scrollIntoError(i),e(r,l)}))}))},validateField:function(e){var t=this,n=e.row,r=e.props,l=e.callback,a=void 0===l?function(){}:l,i={};r=r||Object.keys(n),r=[r].flat(),r.forEach((function(e){var r=t.validateHash[e];if(r){var l=r(n),a=l.rules,o=l.isFormItem;o&&(i[e]=a)}}));var o=new F["default"](i);o.validate(n,(function(e,t){if(t){var r={};Object.entries(t).forEach((function(e){var t=Object(R["a"])(e,2),l=t[0],a=t[1],i="".concat(n._prop,".").concat(l),o=a.map((function(e){return Object(k["a"])(Object(k["a"])({},e),{},{field:i})}));r[i]=o,n._errorFields.push(l)})),a(!1,r)}else n._errorFields=[],a(!0,{})}))},clearValidate:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.rows,r=t.props,l=function t(n){n.forEach((function(n){if(r)for(var l=n._errorFields,i=l.length-1;i>=0;i--){var o=l[i];r.includes(o)&&l.splice(i,1)}else n._errorFields=[];if(a){var s=n[e.treeProps.children];s&&t(s)}}))},a=!1;n||(n=this.tableData,a=!0),n=[n].flat(),r&&(r=[r].flat()),l(n)},getRowPosition:function(e){var t=this,n=function n(l){return l.some((function(l){if(r++,l===e)return!0;if(t.expandRowKeys.includes(l[t.rowKey])){var a=l[t.treeProps.children];if(a)return n(a)}}))},r=-1,l=e._ancestors;l&&this.toggleExpandRowKeys(l,!0);var a=this.tableData;return n(a),r},scrollIntoError:function(e){var t=this.getRowPosition(e),n=this.$refs.tableRef.$el,r=n.querySelector(".el-table__body-wrapper");r.scrollTop=t*this.lineHeight},watchFlatLen:function(){this.$watch((function(){var e={len:0};return this.getFlatLen(this.tableData,e),e.len}),(function(e){this.expandRowKeys.length&&(this.hasDefaultExpandAll=!0),this.pretreatment(this.tableData,"tableData",e)}),{immediate:!0})},getFlatLen:function(e,t){var n=this;e.forEach((function(e){var r=e[n.treeProps.children];r&&n.getFlatLen(r,t)})),t.len+=e.length},hackCheckAllChange:function(){var e=this;this.showHeader=!1,this.$nextTick((function(){e.showHeader=!0,e.$nextTick((function(){var t=e.$refs.tableRef.$el,n=t.querySelector(".el-table__body-wrapper"),r=t.querySelector(".el-table__header-wrapper");r.scrollLeft=n.scrollLeft}))}))},clearSelection:function(){this.doCheck(!1)},toggleRowSelection:function(e,t){"boolean"===typeof t?this.doCheck(t,e):this.doCheck(!e._checked,e)},toggleAllSelection:function(e){"boolean"===typeof e?this.doCheck(e):this.doCheck(!this.checkAll)},handleSelect:function(e,t){var n=this.doCheck(e,t);this.$emit("select",n,t,e)},getSelection:function(){var e=this,t=function t(r){r.forEach((function(r){r._checked&&n.push(r);var l=r[e.treeProps.children];l&&t(l)}))},n=[],r=this.tableData;return t(r),n},doCheck:function(e,t){var n=this,l=function e(t,l){var a=[];if(l?(r["default"].set(l,"_checked",t),r["default"].set(l,"_indeterminate",!1),a=l[n.treeProps.children]||[]):a=n.tableData,a.forEach((function(n){e(t,n)})),l){var i=l._ancestors;i&&i.forEach((function(e){var t=e[n.treeProps.children],l=t.every((function(e){return!e._checked})),a=t.every((function(e){return e._checked}));r["default"].set(e,"_checked",a),l||a?r["default"].set(e,"_indeterminate",!1):r["default"].set(e,"_indeterminate",!0)}))}};l(e,t);var a=this.getSelection();return this.$emit("selection-change",a),a},initTable:function(){var e=this.$refs.tableRef,t=e.$el;t.style.setProperty("--lineHeight","".concat(this.lineHeight,"px")),setTimeout((function(){e.doLayout()}))},handleScroll:function(){this.debounceOnScroll()},getRealCols:function(){var e=this,t=this.$refs.tableRef.$el,n=t.querySelector("colgroup"),r=n.querySelectorAll("col"),l={};Object(D["a"])(r).reduce((function(e,t,n){return l[n]={left:e,right:e+Number(t.width)},l[n].right}),0);var a=t.querySelector(".el-table__body-wrapper");this.scrollLeft=a.scrollLeft;var i=this.scrollLeft+a.clientWidth,o=[];Object.entries(l).forEach((function(t){var n=Object(R["a"])(t,2),r=n[0],l=n[1],a=l.left,s=l.right;if(a>i||s<e.scrollLeft)return!1;o.push(r)})),this.realCols=o},refreshHeight:function(e){var t=e.totalHeight,n=e.prevHeight,r=this.$refs.tableRef.$el;r.style.setProperty("--prevHeight","".concat(n.height,"px")),r.style.setProperty("--totalHeight","".concat(t.height,"px"))},getRealData:function(){var e=this.$refs.tableRef;if(!e)return!1;var t=e.$el,n=t,r=n.clientHeight,l=t.querySelector(".el-table__header-wrapper");l&&(r-=l.clientHeight),this.showSummary&&(r-=this.lineHeight);var a=e.$el.querySelector(".el-table__body-wrapper"),i=a.scrollTop,o=[],s={height:0},c={height:0};this._getRealData({scrollTop:i,clientHeight:r,data:this.tableData,realData:o,totalHeight:s,prevHeight:c}),this.refreshHeight({totalHeight:s,prevHeight:c}),this.realData=o,this.getVirtualIds({realData:o,scrollTop:i,prevHeight:c,clientHeight:r})},_getRealData:function(e){var t=this,n=e.scrollTop,r=e.clientHeight,l=e.data,a=e.realData,i=e.totalHeight,o=e.prevHeight;l.forEach((function(e){var l=t.getGroupHeight(e);if(i.height+l<n)o.height+=l;else if(i.height<=n+r){a.push(e);var s={height:t.lineHeight};t._setChildren({item:e,totalHeight:i,scrollTop:n,clientHeight:r,currentGroupHeight:s})}i.height+=l}))},getGroupHeight:function(e){var t=this,n=function e(n){r+=1;var l=n[t.treeProps.children];t.expandRowKeys.includes(n[t.rowKey])&&l&&l.forEach((function(t){e(t)}))},r=0;return n(e),r*this.lineHeight},_setChildren:function(e){var t=this,n=e.item,r=e.totalHeight,l=e.scrollTop,a=e.clientHeight,i=e.currentGroupHeight;if(n[this.treeProps.children])if(this.expandRowKeys.includes(n[this.rowKey])){n[this.childrenKey]=[];var o=n[this.treeProps.children];o.forEach((function(e,o){r.height+i.height<=l+a?(n[t.childrenKey].push(e),i.height+=t.lineHeight,t._setChildren({item:e,totalHeight:r,scrollTop:l,clientHeight:a,currentGroupHeight:i})):o||(n[t.childrenKey].push(e),delete e[t.childrenKey])}))}else n[this.childrenKey]=n[this.treeProps.children].slice(0,1)},getVirtualIds:function(e){var t=e.realData,n=e.scrollTop,r=e.prevHeight,l=e.clientHeight,a=n-r.height,i=[a,a+l],o={height:0},s=[];this._getVirtualIds({virtualIds:s,visibleHeightClosure:i,data:t,isAncestorExpand:!0,virtualTotalHeight:o}),this.virtualIds=s},_getVirtualIds:function(e){var t=this,n=e.virtualIds,r=e.visibleHeightClosure,l=e.data,a=e.isAncestorExpand,i=void 0===a||a,o=e.virtualTotalHeight;l.forEach((function(e){i?((o.height+t.lineHeight<r[0]||o.height>r[1])&&n.push(e[t.rowKey]),o.height+=t.lineHeight):n.push(e[t.rowKey]);var l=i&&t.expandRowKeys.includes(e[t.rowKey]),a=e[t.childrenKey];a&&t._getVirtualIds({virtualIds:n,visibleHeightClosure:r,data:a,isAncestorExpand:l,virtualTotalHeight:o})}))},toggleExpandRowKeys:function(e,t){var n,r,l=this,a=this.expandRowKeys,i=e.map((function(e){return e[l.rowKey]}));if(t)(r=a).push.apply(r,Object(D["a"])(i));else for(var o=a.length-1;o>=0;o--){var s=a[o];i.includes(s)&&a.splice(o,1)}a=new Set(a),this.expandRowKeys.length=0,(n=this.expandRowKeys).push.apply(n,Object(D["a"])(a))},doExpand:function(e,t){this.toggleExpandRowKeys(e,t),this.getRealData()},expandChange:function(e,t){this.doExpand([e],t)}}},B=G,J=(n("a43f"),Object(b["a"])(B,j,E,!1,null,null,null)),Q=J.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table-column",e._g(e._b({ref:"tableColumnRef",scopedSlots:e._u([{key:"header",fn:function(t){return[e._t("header",(function(){return[e._v(" "+e._s(e.label)+" ")]}),null,t)]}},{key:"default",fn:function(t){return[n("error-item",e._b({},"error-item",Object.assign({},e.$attrs,e.$props,t),!1),[e.activeId!==t.row.id?e._t("default",(function(){return[n("div",{staticClass:"el-input__inner cell--text"},[e._v(" "+e._s(t.row[e.prop])+" ")])]}),null,t):e._e(),e.activeId===t.row.id?e._t("edit",(function(){return[e._t("default",(function(){return[n("div",{staticClass:"el-input__inner cell--text"},[e._v(" "+e._s(t.row[e.prop])+" ")])]}),null,t)]}),null,t):e._e()],2)]}}],null,!0)},"table-column",Object.assign({},e.$attrs,e.$props),!1),Object.assign({},e.$listeners)))},X=[],Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"el-form-item",class:{"is-error":e.row._errorFields.includes(e.prop)}},[e._t("default")],2)},Z=[],ee={inheritAttrs:!1,inject:["validateField"],props:{row:{type:Object,default:function(){return{}}},prop:{type:String,default:""}},mounted:function(){var e=this.$watch((function(){return this.row[this.prop]}),(function(){this.validateField({row:this.row,props:[this.prop]})}));this.$once("hook:beforeDestroy",(function(){e()}))}},te=ee,ne=(n("cc45"),Object(b["a"])(te,Y,Z,!1,null,null,null)),re=ne.exports,le={name:"VirtualTableColumn",components:{TableColumn:l["TableColumn"],ErrorItem:re},inheritAttrs:!1,props:{prop:{type:String,default:""},label:{type:String,default:""},fixed:{type:[Boolean,String],default:!1}},data:function(){return{activeId:""}},mounted:function(){var e=this;N((function(t){e.activeId=t}))}},ae=le,ie=(n("f370"),Object(b["a"])(ae,U,X,!1,null,null,null)),oe=ie.exports;r["default"].component(w.name,w),r["default"].component(H.name,H);var se=[Q,oe],ce=function(e){se.forEach((function(t){e.component(t.name,t)}))};"undefined"!==typeof window&&window.Vue&&ce(window.Vue);var ue={version:"0.0.1",install:ce,VirtualTable:Q};r["default"].use(a.a),r["default"].use(ue),r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e(m)}}).$mount("#app")},"84e7":function(e,t,n){},"85ec":function(e,t,n){},a43f:function(e,t,n){"use strict";n("ad16")},ad16:function(e,t,n){},ba93:function(e,t,n){},cc45:function(e,t,n){"use strict";n("ba93")},f370:function(e,t,n){"use strict";n("84e7")}});
//# sourceMappingURL=app.88b005d5.js.map